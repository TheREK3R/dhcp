#
# Generated by Chef for <%= node['fqdn'] %>
# Do NOT modify this file by hand, changes will be overwritten.
#

# set this to store vendor strings.
set vendor-string = option vendor-class-identifier;

<% unless nil_or_empty?(@failover) -%>
# DHCP failover configuration include
include "/etc/dhcp/dhcpd.failover.conf";

<% end -%>
<% unless nil_or_empty?(@allow) && nil_or_empty?(@deny) && nil_or_empty?(@ignore) -%>
# Request Control
<% unless nil_or_empty?(@allow) -%>
# Allow
<% @allow.each do |allow| -%>
allow <%= allow %>;
<% end -%>
<% end -%>
<% unless nil_or_empty?(@deny) -%>
# Deny
<% @deny.each do |deny| -%>
deny <%= deny %>;
<% end -%>
<% end -%>
<% unless nil_or_empty?(@ignore) -%>
# Ignore
<% @ignore.each do |ignore| -%>
ignore <%= ignore %>;
<% end -%>
<% end -%>

<% end -%>
<% unless nil_or_empty?(@parameters) -%>
# Global Parameters
<% @parameters.sort.each do |key, value| -%>
<%= key %> <%= value %>;
<% end -%>

<% end -%>
<% unless nil_or_empty?(@options) -%>
# Global Options
<% @options.sort.each do |key, value| -%>
option <%= key %> <%= value %>;
<% end -%>

<% end -%>
<% unless nil_or_empty?(@keys) -%>
# TSIG Keys
<% @keys.each do |key, data| -%>
key "<%= key %>" {
  algorithm <%= data['algorithm'] %>;
  secret "<%= data['secret'] %>";
};
<%end -%>

<%end -%>
<% unless nil_or_empty?(@zones) -%>
# Dynamic DNS Zones
<% @zones.each do |zone, data| -%>
zone <%= zone %>. {
  primary <%= data["master"] %>;
  key "<%= data["key"] %>";
}
<% end -%>

<% end -%>
# Includes
include "<%= @includes_dir %>/classes.d/list.conf";
include "<%= @includes_dir %>/groups.d/list.conf";
include "<%= @includes_dir %>/subnets.d/list.conf";
include "<%= @includes_dir %>/shared_networks.d/list.conf";
include "<%= @includes_dir %>/hosts.d/list.conf";

<% unless nil_or_empty?(@include_files) -%>
# Custom Includes
<% @include_files.each do |file| -%>
include "<%= file %>";
<% end -%>

<% end -%>
<% unless @extra_lines.nil? || @extra_lines.empty? -%>
# User specified extra lines
<% property_array(@extra_lines).each do |line| -%>
<%= line %>
<% end -%>

<% end -%>