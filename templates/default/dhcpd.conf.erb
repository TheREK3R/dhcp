#
# Generated by Chef for <%= node['fqdn'] %>
# Do NOT modify this file by hand, changes will be overwritten.
#

# set this to store vendor strings.
set vendor-string = option vendor-class-identifier;

<% if @failover -%>
# DHCP failover configuration include
include "/etc/dhcp/dhcpd.failover.conf";
<% end -%>

<% unless @allow.empty? && @deny.empty? && @ignore.empty? -%>
# Request control
<% @allow.each do |allow| -%>
allow <%= allow %>;
<% end -%>

<% @deny.each do |deny| -%>
deny <%= allow %>;
<% end -%>

<% @ignore.each do |ignore| -%>
ignore <%= allow %>;
<% end -%>
<% end -%>

# Global Parameters
<% @parameters.sort.each do |key, value| -%>
<%= key %> <%= value %>;
<% end -%>

# Global Options
<% @options.sort.each do |key, value| -%>
option <%= key %> <%= value %>;
<% end -%>

<% unless @keys.empty? -%>
# TSIG Keys
<% @keys.each do |key, data| -%>
key "<%= key %>" {
  algorithm <%= data['algorithm'] %>;
  secret "<%= data['secret'] %>";
};
<%end -%>
<%end -%>

<% unless @zones.empty? -%>
# Dynamic DNS Zones
<% @zones.each do |zone, data| -%>
zone <%= zone %>. {
  primary <%= data["master"] %>;
  key "<%= data["key"] %>";
}
<% end -%>
<% end -%>

include "<%= node['dhcp']['dir'] %>/classes.d/list.conf";
include "<%= node['dhcp']['dir'] %>/groups.d/list.conf";
include "<%= node['dhcp']['dir'] %>/subnets.d/list.conf";
include "<%= node['dhcp']['dir'] %>/shared_networks.d/list.conf";
include "<%= node['dhcp']['dir'] %>/hosts.d/list.conf";

<% node['dhcp']['extra_files'].each do |file| -%>
include "<%= file %>";
<% end -%>
